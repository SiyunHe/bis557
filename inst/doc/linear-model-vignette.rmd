---
title: "The Linear Model"
author: "Michael J. Kane"
date: "`r Sys.Date()`"
output:
  html_document:
    self_contained: yes
    toc: true
---
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{The liner model vignette}
-->

## The linear_model function

The linear model is the "hello world" of machine learning models.

```{r}
#library(bis557)
#fit <- linear_model(Sepal.Length ~ ., iris)
#summary(fit)

#' Fit a linear model
#'
#' @description This function passes parameters to the lm function.
#' @param formula a formula
#' @param data a data.frame
#' @return An lm object
#' @importFrom stats lm
#' @examples
#' fit <- linear_model(Sepal.Length ~., iris)
#' summary(fit)
#' @export

load("/Users/siyunhe/Desktop/Year 2/BIS557/bis557/data/lm_patho.rda")

linear_model <- function(formula, data) {
  #browser()
  a<- all.vars(formula)
  y <- data[,a[1]]
  mm <- model.matrix(formula, data)
  x<-mm
  output <- list()
  output$coefficients <- qr.coef(qr(x),y)
  #output$call <- call("linear_model",formula)
  class (output) = "lm"
  return(output)
}
```
